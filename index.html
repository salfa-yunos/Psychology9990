
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Psychology Revision Game</title>

<style>
body {
    font-family: 'Segoe UI', sans-serif;
    margin:0;
    background: linear-gradient(135deg,#667eea,#764ba2);
    color:white;
    text-align:center;
}

h1 {
    padding:20px;
    font-size:32px;
}

.card {
    background:white;
    color:#333;
    padding:25px;
    margin:20px auto;
    width:90%;
    max-width:750px;
    border-radius:20px;
    box-shadow:0 10px 30px rgba(0,0,0,0.3);
}

button {
    padding:12px 18px;
    margin:8px;
    border:none;
    border-radius:12px;
    font-size:16px;
    cursor:pointer;
    background: linear-gradient(135deg,#ff9a9e,#fad0c4);
    transition:0.3s;
}

button:hover {
    transform:scale(1.05);
    background: linear-gradient(135deg,#a18cd1,#fbc2eb);
}

#answers button {
    display:block;
    width:80%;
    margin:10px auto;
}

textarea {
    width:90%;
    height:120px;
    border-radius:10px;
    padding:10px;
}

.topic-btn {
    background: linear-gradient(135deg,#43e97b,#38f9d7);
}

.topic-btn:hover {
    background: linear-gradient(135deg,#30cfd0,#330867);
    color:white;
}

</style>
</head>
<body>

<h1>ðŸ§  Psychology Revision Game</h1>

<div id="menu" class="card">
<h2>Select a Topic</h2>
<div id="topicButtons"></div>
</div>

<div id="game" class="card" style="display:none;">
<div>
Lives: <span id="lives"></span> |
XP: <span id="xp">0</span> |
Time: <span id="timer">0</span>s
</div>

<h3 id="topicTitle"></h3>
<div id="question"></div>
<div id="answers"></div>
<textarea id="essayBox" style="display:none;"></textarea>
<br>
<button id="submitEssay" style="display:none;" onclick="submitEssay()">Submit Essay</button>
</div>

<div id="results" class="card" style="display:none;"></div>

<script>

let audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function playTone(freq){
    let osc = audioCtx.createOscillator();
    osc.type="sine";
    osc.frequency.value=freq;
    osc.connect(audioCtx.destination);
    osc.start();
    setTimeout(()=>osc.stop(),200);
}

function soundCorrect(){playTone(600);}
function soundWrong(){playTone(200);}

let questionBank = [
{topic:"Biological",type:"mcq",marks:1,time:30,
question:"Which part of the neuron receives impulses?",
options:["Axon","Dendrite","Myelin","Synapse"],answer:1},

{topic:"Cognitive",type:"mcq",marks:1,time:30,
question:"Which memory store has the shortest duration?",
options:["Long-term","Working","Sensory","Procedural"],answer:2},

{topic:"Research Methods",type:"essay",marks:10,time:300,
question:"Discuss strengths and weaknesses of laboratory experiments."}
];

let lives = 3;
let xp = 0;
let score = 0;
let currentTopic = "";
let questions = [];
let currentQuestionIndex = 0;
let timerInterval;

function loadTopics(){
    let topics = [...new Set(questionBank.map(q=>q.topic))];
    let container = document.getElementById("topicButtons");
    topics.forEach(topic=>{
        let btn = document.createElement("button");
        btn.innerText = topic;
        btn.className="topic-btn";
        btn.onclick=()=>startGame(topic);
        container.appendChild(btn);
    });
}

function startGame(topic){
    currentTopic = topic;
    questions = questionBank.filter(q=>q.topic===topic);
    document.getElementById("menu").style.display="none";
    document.getElementById("game").style.display="block";
    document.getElementById("topicTitle").innerText=topic;
    updateLives();
    loadQuestion();
}

function updateLives(){
    document.getElementById("lives").innerHTML="â¤ï¸".repeat(lives);
}

function loadQuestion(){
    if(currentQuestionIndex>=questions.length){endGame(); return;}
    let q=questions[currentQuestionIndex];
    document.getElementById("question").innerText=q.question;
    document.getElementById("answers").innerHTML="";
    document.getElementById("essayBox").style.display="none";
    document.getElementById("submitEssay").style.display="none";

    startTimer(q.time);

    if(q.type==="mcq"){
        q.options.forEach((opt,i)=>{
            let btn=document.createElement("button");
            btn.innerText=opt;
            btn.onclick=()=>checkAnswer(i===q.answer,q.marks);
            document.getElementById("answers").appendChild(btn);
        });
    }
    else{
        document.getElementById("essayBox").style.display="block";
        document.getElementById("submitEssay").style.display="inline-block";
    }
}

function checkAnswer(correct,marks){
    clearInterval(timerInterval);
    if(correct){
        score+=marks;
        xp+=marks*10;
        soundCorrect();
    }
    else{
        lives--;
        soundWrong();
        if(lives<=0){endGame();return;}
    }
    updateLives();
    currentQuestionIndex++;
    loadQuestion();
}

function submitEssay(){
    clearInterval(timerInterval);
    let text=document.getElementById("essayBox").value;
    let q=questions[currentQuestionIndex];
    let result=text.length>150 ? q.marks : Math.floor(q.marks/2);
    alert("Essay Score: "+result+"/"+q.marks);
    checkAnswer(result>=q.marks/2,q.marks);
}

function startTimer(seconds){
    let time=seconds;
    document.getElementById("timer").innerText=time;
    timerInterval=setInterval(()=>{
        time--;
        document.getElementById("timer").innerText=time;
        if(time<=0){
            clearInterval(timerInterval);
            lives--;
            updateLives();
            if(lives<=0){endGame();}
            else{
                currentQuestionIndex++;
                loadQuestion();
            }
        }
    },1000);
}

function endGame(){
    document.getElementById("game").style.display="none";
    document.getElementById("results").style.display="block";
    document.getElementById("results").innerHTML=
    "<h2>ðŸŽ‰ Game Over</h2>"+
    "Score: "+score+"<br>"+
    "XP: "+xp+"<br>"+
    "<button onclick='location.reload()'>Play Again</button>";
}

loadTopics();

</script>
</body>
</html>
